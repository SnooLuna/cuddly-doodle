---
title: "DataProcessing"
author: "Group 4"
date: "`r Sys.Date()`"
output: html_document
---

## Setup and loading data

```{r libraries, include=FALSE}
library(plyr)
library(dplyr)
library(plotfunctions)
library(readr)
library(data.table)
```

```{r dataframe}
# Create empty list for saving each subject
list = c()
# Read in data for each subject
for (n in 10:15){
    subject <- read.csv(paste0("data//subject-", n, ".csv"))
    # Save subject information, remove empty rows
    age <- subject$response[1]
    gender <- subject$response[2]
    subject$subject <- paste0("s", n)
    subject$age <- as.integer(age)
    subject$gender <- gender
    subject <- subject[-c(1:2), ]
    list[[length(list) + 1]] <- subject
}
# Bind all dataframes together
data <- rbindlist(list)
# Remove known outlier (experiment was interrupted)
data <- subset(data, retrieval_t < 50000) 
# Clear workspace of leftovers
rm(list = setdiff(ls(), "data"))
```


```{r cleanup}
# Remove the column containing only the "OK" response starting the experiment
data <- select(data, -form_response)

# These columns contain duplicate data values that exist because they are not used
time_cols <- c("time_block_loop", "time_block_sequence", "time_correct_answer", "time_cue", "time_fixation_cross", "time_fixation_dot", "time_incorrect_answer", "time_keyboard", "time_press_spacebar", "time_study_screen", "time_test_screen")

# We set all duplicate values in those columns to NA value, and adjust the values according to timestamps
for (col in time_cols){
    data[[col]][duplicated(data[[col]])] <- NA
}

data$accuracy <- ifelse(is.na(data$time_correct_answer), "incorrect", "correct")

# Clear workspace of leftovers
rm(list = setdiff(ls(), "data"))
```

## Descriptive Statistics

```{r}
# Mean age:
mean(data$age)
# Ages of participants:
table(data$age) / 120
# Gender of participants:
table(data$gender) / 120

# Distribution of responses per block:
table(data$subject, data$block, data$accuracy)

# Some average retrieval time values
data %>%
    group_by(subject, accuracy, block) %>%
    summarize(mean_retrieval_time = mean(retrieval_t))
```

